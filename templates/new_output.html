<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,wght@0,100..900;1,100..900&family=Shantell+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
  
  <meta charset="UTF-8">
  <title>Served - Your Anime Bento</title>
  <style>
      :root {
  --cursor-glow: #FFFA5F;
}
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
.contents {
  display: flex;
  flex-direction: column;
  padding: 0 0;
  align-items: center;
  width:100%;
  gap: 16px;
}

.main-content {
    position: relative;
      flex: 1;
  display: flex;
  flex-direction: row;
  align-items: center; 
  gap: 16px;
}


#cursor-glow {
  position: fixed;
  width: 20px;
  height: 20px;
  background-color: var(--cursor-glow);
  border-radius: 50%;
  pointer-events: none;
  opacity: 0.9;
  filter: blur(16px);
  z-index: 9999;
  transform: translate(-50%, -50%);
  mix-blend-mode: screen;
}

    body, html {
       height: 100vh; /* Lock it to viewport height */
  overflow: hidden; /* Prevent page scroll */
  display: flex;
  flex-direction: column;
      height: 100%;
      background: linear-gradient(0deg, rgba(1, 16, 24, 0.90) 0%, rgba(1, 16, 24, 0.90) 100%), url('../static/background.jpg') lightgray 50% / cover no-repeat;
    }

    h1 {
      font-family: 'Shantell Sans', cursive;
      color:  rgba(211, 239, 255, 1);
      font-size: 32px;
    }

    p {
      font-family: 'Inter', sans-serif;
      color: rgba(211, 239, 255, 1);
      font-size: 16px;
    }

    img {
      width: 100px;
      height: auto;
    }

    .header-text {
        display: flex;
flex-direction: column;
justify-content: center;
align-items: center;
gap: 8px;
    }

    .website-header {
  padding: 16px 200px;
        display: flex;
        flex-direction: row;
align-items: center;
gap: 320px;
width: 100%;
    }
    .bento-tooltip {
  transform: translate(calc(-100% + 10px));
  margin-left: 4px;
  margin-right: 4px;
  position: absolute;
  top: 110%;
  left: 50%;
  background-color: rgba(1, 16, 24, 1.0);
  color: #D3EFFF;
  padding: 12px;
  border-radius: 10px;
  width: 250px;
box-shadow: 4px 4px 15px 0px #00A6FF;
  font-family: 'Inter', sans-serif;
  font-size: 14px;
  line-height: 1.4;
  z-index: 100;
   opacity: 0;
  pointer-events: auto;
  transition: opacity 0.6s ease-in-out; 
}


.bento-tooltip img {
  width: 100%;
  border-radius: 6px;
  margin-bottom: 8px;
}

/* Tooltip arrow â€” pointing top-left-ish (to the logo) */
.bento-tooltip::before {
  content: '';
  position: absolute;
  top: -10px;
  right: 16px; /* Adjust this to move the arrow more/less to the side */
  border-width: 0 10px 10px 10px;
  border-style: solid;
  border-color: transparent transparent rgba(1, 16, 24, 0.95) transparent;
}

.logo-wrapper {
  position: relative;
  display: inline-block;
}

.tooltip-dismiss {
  background: none;
  border: none;
  color: #D3EFFF;
  font-size: 12px;
  cursor: pointer;
  margin-top: 8px;
  text-align: right;
  padding: 0;
  font-family: 'Inter', sans-serif;
  text-decoration: underline;
}


.website-header:hover .bento-tooltip {
  opacity: 1;
  pointer-events: auto;
}

.alert {
  background: #FFF834;
box-shadow: 4px 4px 10px 0px #FFFF8D;
font-size: 18px;
color: #011018;
padding: 16px 16px;
border-radius: 20px;
align-items: center;
display: none;
opacity: 0;
flex-direction: row;
width:100%;
cursor: pointer;
transition: box-shadow 0.5s ease, 
opacity 1.0s ease;
}

.alert:hover {
  box-shadow: 0 0 30px #FFFF8D;
}

.prev-next-btn {
padding: 16px 24px;
align-items: center;
border-radius: 20px;
background: #011018;
box-shadow: 4px 4px 10px 0px #00A6FF;
font-size: 18px;
color: #D3EFFF;
font-family: 'Inter';
border: #D3EFFF 1px solid;
border-radius: 20px;
transition: box-shadow 0.5s ease,  
transform 0.3s ease;
}

.prev-next-btn:hover {
  box-shadow: 0 0 20px #00A6FF, 0 0 30px #D3EFFF;
    transform: translateY(-8px);
}

.prev-next-btn:active {
    transform: scale(0.9); 
}

.main-bento-body {
        flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;  /* This is what centers horizontally */
  gap: 16px;
  width: 100%;
}

.anime-title, .epCount {
  display: flex;
  flex-direction: row;  
  justify-content: center;
  align-items: center;
  gap: 8px;
padding: 16px 16px;
border-radius: 20px;
background: #011018;
box-shadow: 4px 4px 50px 0px #00A6FF;
max-height: 20%;
width: 100%;
transition: transform 0.3s ease-in-out;
}

.anime-title:hover, .epCount:hover {
  transform: translateY(-8px);
}

.title-slno {
  display: flex;
  flex-direction: row;  
  justify-content: center;
  align-items: center;
  gap: 8px;
padding: 16px 16px;
border-radius: 20px;
max-height: 20%;
width: 100%;
}

.slno {
  display: flex;
  flex-direction: row;
  justify-content: center;
  padding: 16px 16px;
  border-radius: 20px;
  background: #011018;
  box-shadow: 4px 4px 50px 0px #00A6FF;
  width: 15%;
  transition: transform 0.3s ease-in-out;
}

.slno:hover {
  transform: translateY(-8px);
}
.synopsis {
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: flex-start; /* This helps keep text aligned at the top */
  padding: 16px 16px;
  border-radius: 20px;
  background: #011018;
  box-shadow: 4px 4px 50px 0px #00A6FF;
  width: 100%;
transition: transform 0.3s ease-in-out;
}

.synopsis:hover {
  transform: translateY(-8px);
}

.filters {
  gap: 8px;
border-radius: 20px;
background: #011018;
box-shadow: 4px 4px 50px 0px #00A6FF;
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-left:8px;
  padding: 16px 16px;
transition: transform 0.3s ease-in-out;
}

.filters:hover {
  transform: translateY(-8px);
}

.poster-and-synopsis {
  display: flex;
flex-direction: row;
align-items: center;
gap: 16px;
}


.anime-poster {
  width: 23%;
      padding: 0 0;
      height: 23%;
      border-radius:20px;
      box-shadow: 4px 4px 50px 0px #00A6FF;
  transition: transform 0.3s ease-in-out, opacity 0.4s ease-out;
}

.anime-poster:hover {
  transform: translateY(-8px); /* rises up slightly */
}


.synopsis-and-epCount{
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 16px;
}

.button-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 32px;
  margin-right:12px;
}

.CTA {
    margin: 0 auto;
     padding: 12px 12px;
     font-family: 'Inter';
     font-size: 18px;
     color: #011722;
    background-color: rgba(255, 255, 95, 1);
gap: 10px;
border-radius: 20px;
box-shadow: 4px 4px 10px 0px #FFFF8D;
border: #FFFF8D 1px solid;
transition: box-shadow 0.5s ease, 
background-color 0.5s ease,  
transform 0.3s ease;

}

.CTA:hover {
  box-shadow: 0 0 20px #FFF834, 0 0 30px #FFFF8D;
    transform: translateY(-4px);
}

.CTA:active {
  background-color: #FFF834; /* Replace this with your gold color */
  border: #FFF834 1px solid;
    transform: scale(0.9); 
}

.fade-transition {
  opacity: 1;
  transition: opacity 1.2s ease-in-out;
}

.fade-transition.fade-out {
  opacity: 0;
}

  </style>
<link rel="icon" href="../static/logo.svg" type="image/x-icon">
</head>
<body>
<div class="contents">
   <div class="website-header">
      <div class="logo-wrapper">
    <img src="{{ url_for('static', filename='logo.svg') }}">
         <div class="bento-tooltip"></div>
      </div>
      <div class="header-text">
            <h1>Sukito</h1>
            <p>Your taste. Your vibe. Your anime bento.</p>
      </div>
       
    </div> 
    
  <div class="main-content"> 
      <div class="filters" id="filter-container">
    <p> Filters Applied </p>
    </div> 
  <div class="main-bento-body">
      <div class="title-slno">
        <div  id="slno" class="slno">
        <h1 id="sl-no" class="fade-transition" style="font-size:20px;"> Sl. No </h1>
        </div>
            <div class="anime-title">
        <h1 id="anime-title" class="fade-transition" style="font-size:20px;"> Anime Title </h1>
        </div>
    </div>
    <div class="poster-and-synopsis">
  <img class="anime-poster" id="anime-poster" src="">

        <div class="synopsis-and-epCount">
        <div class="synopsis"> 
            <p class="fade-transition" id="synopsis"> </p>
        </div>
        <div class ="epCount">
            <p class="fade-transition" id="epCount"> </p>
        </div>
      </div>
    </div> 
    
</div>
<div class="button-wrapper">
   <div class="alert" style="margin-top:0;" id="alert-modal" onclick="closeModal('alert-modal')">
        <p style="color: #011018;" id="alert"> Alert </p>
      </div> 
  <button class="prev-next-btn" onclick="showPreviousAnime()"> Previous </button>     
 <button class="prev-next-btn" onclick="showNextAnime()"> Next </button>
  <button class="CTA" style="margin-top:80px;" onclick="window.location.href='{{ url_for('new_input') }}'">One more round!</button>
   </div>
    </div> 

<div id="cursor-glow"></div>
</body>
   <script>
  const glow = document.getElementById("cursor-glow");
  const tooltip = document.querySelector('.bento-tooltip');
const header = document.querySelector('.website-header');

  document.addEventListener("mousemove", (e) => {
    glow.style.left = e.clientX + "px";
    glow.style.top = e.clientY + "px";
  });

  const sections = [
    { class: 'slno', color: '#00A6FF' },  
    { class: 'filters', color: '#00A6FF' },   
    { class: 'poster', color: '#00A6FF' },     
    { class: 'anime-title', color: '#00A6FF' },     
    { class: 'synopsis', color: '#00A6FF' },
    { class: 'epCount', color: '#00A6FF' }    
  ];

  sections.forEach(({ class: cls, color }) => {
    const el = document.querySelector(`.${cls}`);
    if (el) {
      el.addEventListener("mouseenter", () => {
        document.documentElement.style.setProperty('--cursor-glow', color);
      });
      el.addEventListener("mouseleave", () => {
        document.documentElement.style.setProperty('--cursor-glow', '#FFFA5F'); 
      });
    }
  });

  let tooltipVisible = true;
let wasDismissed = false;

const firstTimeHeader = "Wondering what a Bento is?";
const reentryHeader = "Welcome back to Bento mode.";
  
  const tips = [
    "A traditional Japanese lunchbox with neatly arranged compartments â€” just like how we serve your anime picks.",
    "Think of bento as an organized meal box. Here, itâ€™s your personalized anime selection.",
    "Bento means balance and structure. Thatâ€™s how we recommend anime to you.",
    "Each anime you choose fits into a bento-style layout â€” simple, neat, curated.",
    "This is your anime bento. Every pick, a tasty little mood.",
    "We serve anime the bento way: no mess, just the best.",
    "Neatly packed anime. Carefully portioned. Surprisingly addictive.",
    "Just like bento: pretty outside, solid content inside.",
     "A bento box = a perfect combo of flavors. Here, it's a perfect combo of anime.",
  "Call it a lunchbox if you want â€” but it's also your personalized anime tray.",
  "Organized anime recommendations. Clean like a bento. Thatâ€™s the idea.",
   "Once a simple Japanese meal box.Now, your custom anime feast."
  ];

  const animeBentoTips = [
    "Just like a bento box â€” your anime picks are neatly packed for max flavor.",
    "Bento doesnâ€™t just mean neat. It means *crafted*. So are your anime picks.",
    "You pick the vibe. We box it up in bento form. Easy.",
    "Neatly arranged anime servings. One genre per compartment. Zero chaos.",
    "Like a bento box â€” small, powerful doses of anime joy.",
    "Every anime recommendation fits into your mood tray. Balanced and binge-ready.",
    "Bento isnâ€™t just food. Itâ€™s a vibe â€” like your personal anime playlist.",
    "Your watchlist? Bento-fied. Balanced, portioned, and satisfying.",
    "Think of this as a lunchbox of stories. Each one a bite-sized adventure.",
    "Anime served like bento: compact, complete, and always aesthetic.",
    "We bento-wrap your taste into handpicked anime bundles.",
    "Your mood = our menu. Bento-style anime recs, no filler.",
  ];
 function updateTooltipContent() {
  const headerText = wasDismissed
    ? reentryHeader
    : firstTimeHeader;

  const tip = wasDismissed
    ? animeBentoTips[Math.floor(Math.random() * animeBentoTips.length)]
    : tips[Math.floor(Math.random() * tips.length)];

  tooltip.innerHTML = `
    <img src="{{ url_for('static', filename='bento.png') }}">
    <h1 style="font-size:14px;">${headerText}</h1>
    <p style="font-size:14px;">${tip}</p>
    <button class="tooltip-dismiss">Got it! Hide this. (Click header to bring it back)</button>
  `;

  addDismissLogic();
}

function addDismissLogic() {
  const dismissBtn = document.querySelector('.tooltip-dismiss');
  dismissBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    tooltipVisible = false;
    wasDismissed = true;
    tooltip.style.opacity = 0;
    tooltip.style.pointerEvents = 'none';
  });
}

// Show tooltip on hover â€” only if it's still allowed
header.addEventListener('mouseenter', () => {
  if (tooltipVisible) {
    tooltip.style.opacity = 1;
    tooltip.style.pointerEvents = 'auto';
  }
});

header.addEventListener('mouseleave', () => {
  if (tooltipVisible) {
    tooltip.style.opacity = 0;
    tooltip.style.pointerEvents = 'none';
  }
});

// Re-enable tooltip + re-randomize on click
header.addEventListener('click', () => {
  tooltipVisible = true;
  updateTooltipContent(); // change header + tip
  tooltip.style.opacity = 1;
  tooltip.style.pointerEvents = 'auto';
});

updateTooltipContent(); // Add this line right before 


// Anime showing
 const animeData = {{ anime_data|safe }};
    let currentIndex = 0;

    function showAnime(index) {
  const slNo = document.getElementById('sl-no');
  const title = document.getElementById('anime-title');
  const poster = document.getElementById('anime-poster');
  const synopsis = document.getElementById('synopsis');
  const epCount = document.getElementById('epCount');

  const elements = [slNo, title, synopsis, epCount];

  // Fade out text
  elements.forEach(el => el.classList.add("fade-out"));

  // Slide poster left

  // Wait for animations to complete
  setTimeout(() => {
    slNo.textContent = index + 1 + ' of ' + animeData.length;
    title.textContent = animeData[index].title;
    synopsis.textContent = animeData[index].synopsis;
    if (animeData[index].episodes=="Episode count currently Unknown. Waiting for new information."){
      epCount.textContent = animeData[index].episodes;
    }
    else{
    epCount.textContent = animeData[index].episodes + ' Episodes';
    }
    // Instantly move poster to right (outside right edge)
    poster.style.transition = "none"; // remove transition temporarily
    poster.style.transform = "translateY(100%)";

    // Update poster src
    poster.src = animeData[index].image_url;

    // Trigger reflow to apply the instant transform
    void poster.offsetWidth;

    // Slide poster into place
    poster.style.transition = "transform 0.4s ease-in-out";
    poster.style.transform = "translateY(0%)";

    // Fade text back in
    elements.forEach(el => el.classList.remove("fade-out"));
  }, 400); // matches the CSS duration
}


   function showNextAnime() {
  if (currentIndex < animeData.length - 1) {
    currentIndex++;
    showAnime(currentIndex);
  } else {
    showAlert("This is the last anime!");
  }
}

function showPreviousAnime() {
  if (currentIndex > 0) {
    currentIndex--;
    showAnime(currentIndex);
  } else {
    showAlert("This is the first anime!");
  }
}

    function closeModal(id) {
  document.getElementById(id).style.display = "none";
}
    showAnime(currentIndex);

function showAlert(message) {
  const modal = document.getElementById('alert-modal');
  modal.innerHTML = `<p style="color:#011018;">${message}</p>`;

  // Show and reset styles
  modal.style.display = 'flex';
  modal.style.opacity = '0';  // Start from invisible

  // Force a slight delay before changing opacity
  setTimeout(() => {
    modal.style.opacity = '1'; // Fade in
  }, 10); // Just enough time for CSS to notice the change

  // Clear any existing timeout
  if (window.alertTimeout) clearTimeout(window.alertTimeout);

  // Fade out after 3s
  window.alertTimeout = setTimeout(() => {
    modal.style.opacity = '0';
    setTimeout(() => modal.style.display = 'none', 500); // Allow fade-out to finish
  }, 3000);
}

const appliedFilters = {{ animefilters|safe }};
const container = document.getElementById("filter-container");

if (appliedFilters == "No filters applied.") {
  // Clear the filter container completely (including the heading)
  container.innerHTML = ""; 

  // Add the simple "No filters applied" text
  const msg = document.createElement("p");
  msg.textContent = "No filters applied.";
  msg.style.fontSize = "16px";
  msg.style.color = "#D3EFFF";  // match the rest of your UI
  container.appendChild(msg);
}

 else {
function createPill(text, color) {
  const btn = document.createElement("button");
  btn.className = "CTA";
  btn.style.backgroundColor = color;
  btn.style.border = "none";
  btn.style.boxShadow = "none";
  btn.style.fontSize = "16px";
  btn.textContent = text;
  container.appendChild(btn);
}

// Genre pills (blue)
(appliedFilters.genres || []).forEach(genre => {
  createPill(genre, "#00A6FF");
});

// Year pill (blue)
if (appliedFilters.year) {
  createPill(appliedFilters.year, "#00A6FF");
}

// Type pill (purple)
if (appliedFilters.type) {
  createPill(appliedFilters.type, "#CC5CFF");
}

// Status pill (green)
if (appliedFilters.status) {
  createPill(appliedFilters.status, "#59FF9D");
}
}
</script>
</html>
